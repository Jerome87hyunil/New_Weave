# Weave: 흩어진 당신의 업무를 하나로 엮다

**통합 기획 및 제품 요구사항 정의서 (v3.2)**
작성일: 2025-08-25 (KST)
작성 범위: 제품/기획/개발/QA/보안/운영 전 부문 공용 문서 (Single Source of Truth)

---

## 0) 변경 이력 (Revision History)

| 버전     | 날짜           | 작성/수정      | 주요 변경점                                                                  |
| -------- | -------------- | -------------- | ---------------------------------------------------------------------------- |
| v3.0     | 2025-08-20     | PM             | 초기 PRD 통합, KPI 초안                                                      |
| v3.1     | 2025-08-24     | PM/Tech        | 대시보드 룰·DocumentRequest 보안 추가                                        |
| **v3.2** | **2025-08-25** | **PM/Tech/QA** | **MVP 스코프 축소, Exit 기준 명시, 데이터 모델·API 스펙·테스트 계획 상세화** |

---

## 1) 제품 개요 & 비전 (Overview & Vision)

### 1.1 제품 정의 (Product Definition)

- **제품명**: **Weave** — _흩어진 당신의 업무를 하나로 엮다_
- **정의**: 프리랜서 맞춤형 **개인화 AI 기반 ERP**. 계약/견적/인보이스/프로젝트/고객/정산/세무 변환까지 **한 플랫폼**에서 **유기적**으로 관리.

### 1.2 비전 (Vision)

- 프리랜서가 **행정 업무에서 해방**되어 **핵심 역량**과 **창의**에 집중하도록 만든다.

### 1.3 포지셔닝 (USP)

- 기존 시장: **삼쩜삼(편의성)** vs \*\*더존(전문 ERP)\*\*로 양분
- **Weave**: 두 영역을 **연결**하는 **ERP→Tax**의 실무형 솔루션. *업무 산출물이 곧 세무 자료*가 되는 경험 제공.

### 1.4 성공 지표 요약 (12\~18개월)

- **MAU 10k** (12개월), **전환율 15%**, **MRR 5천만\~1억** 목표 (세부 가설은 §10, §14)

---

## 2) 시장·사용자 (Market & Users)

### 2.1 문제 정의 (Pain Points)

1. **행정 과부하**: 다툴(노션/슬랙/메일/시트) 분산 + 수기 복제/전사 → 시간 낭비·실수
2. **정산·세무 리스크**: 미수금 추적 실패, 증빙/계약 보관 미흡, 분쟁 취약
3. **영업 손실**: 커뮤니케이션 이력·리마인드 체계 부재로 기회 상실

### 2.2 페르소나 (Personas)

- **P1 김민수**: 웹개발 프리랜서 4년차, 동시 5~~7 프로젝트, 월 10+ 문서 작성, 하루 3~~4시간 행정
- **P2 이지은**: 디자이너 7년차, 소규모 협업(2\~3인), 견적·수금·저작권 계약 민감
- **P3 박현우**: 영상 프리랜서, 외주 빈도 높음, 미수금·세금 증빙 자동화 니즈

### 2.3 가치 제안 (Value)

- **E2E 정합성**: 견적→계약→인보이스→입금→세무 변환 **흐름 유지**
- **클릭 절감**: 템플릿/자동 채움/빠른 실행
- **리스크 축소**: 기한/미수금/증빙 **알림** + 감사로그

---

## 3) 범위 (Scope)

### 3.1 In-Scope (v3.2 기준)

- 문서 템플릿 엔진(견적/인보이스) & 버전 관리
- 인보이스 발행→입금 추적→리마인드 자동화
- **통합 대시보드(룰 기반 인사이트 4종)**
- **DocumentRequest**(로그인 없이 보안 업로드: 만료/1회용/감사로그)
- 최소 CRM/프로젝트(마감·금액·상태) + 캘린더 _읽기_
- 세무 변환 **내보내기 패킷**(핸드오프) — _대리신고는 파트너 체결 전까지 옵션_
- **홈 콘텐츠 섹션(공지/가이드/세금 팁 3\~5개)** — 에버그린 중심, 운영 최소화

### 3.2 Out-of-Scope (MVP 시점)

- 전자서명 **직접 제공**(→ 외부 연동 옵션으로만)
- 복잡 AI(요약/추천) — _OCR+필드 추출 중심_
- 풀 편집 캘린더/고급 협업(권한 세분화 제외)

---

## 4) 사용자 시나리오 (핵심 플로우)

### 4.1 신규 프로젝트 수주 & 착수 (요약)

1. 홈 → 대시보드 진입, ‘결제 지연/마감 임박’ 확인
2. 신규 프로젝트 생성 → 클라이언트 선택/등록
3. **견적서 생성**(템플릿+자동 채움) → 발송
4. 승인 시 **계약 초안 자동 생성**(P2 이후) → 전자서명 요청(연동 옵션)
5. 인보이스 발행 → 입금 추적 → 리마인드 자동화
6. 필요 자료 **DocumentRequest**로 회수 (링크 만료·1회용·로그)
7. 캘린더 *읽기 뷰*에서 마감일 자동 표시

> 상세 단계/화면 정의는 §8 ‘UX/IA’와 §9 ‘대시보드 룰’ 참조

---

## 5) 기능 요구사항 (Functional Requirements)

### 5.1 문서 템플릿 엔진

- 변수 치환(`{{client.name}}`, `{{invoice.total}}`), 조건부(If/Each), 버전·프리셋 관리
- 미리보기/내보내기(PDF), 서명URL(만료)로 공유
- **에러 처리**: 누락 변수 표기/기본값·검증 경고

### 5.2 인보이스/결제 추적/리마인드

- 상태: Draft/Issued/Overdue/Paid/Cancelled
- 기한·부분입금·수수료 필드, 자동 합계/세액
- 리마인드: 규칙 편집(발행+7일, 기한 당일, 3일 후 등) + 이력 로그

### 5.3 DocumentRequest (보안 업로드)

- 단건 토큰 링크, TTL(기본 7일), 첨부 형식/용량 제한,
- **감사 로그**: 발송/열람/업로드/다운로드 IP·UA·시간 기록

### 5.4 통합 대시보드(룰 기반 인사이트 4종)

- R1 **결제 지연 청구서**
- R2 **마감 임박 프로젝트(7일)**
- R3 **이번 달 발행 vs 입금 현황**
- R4 **상위 고객별 매출 기여(최근 분기)**
- 각 카드 CTA: 상세 필터 뷰, ‘리마인드 보내기’ 등

### 5.5 CRM/프로젝트/캘린더(_읽기_)

- 클라이언트: 회사/담당자/연락처/사업자등록 기초 필드
- 프로젝트: 상태(Open/Hold/Closed), 마감·예산·고객 연결
- 캘린더: **인보이스 기한/프로젝트 마감일 자동 표기**

---

## 6) 비기능 요구사항 (NFR)

- **가용성**: 월 99.5% (MVP), 알림/리마인드 지연 < 5분
- **성능**: 대시보드 TTFB < 800ms(99th), 문서 생성 < 3s
- **보안**: RLS 격리, 데이터 전송/저장 암호화, 링크 TTL/1회용, 최소 권한 원칙
- **프라이버시**: PII 최소화, 보존·파기 정책, 감사로그 180일 보관
- **비용**: AI 월한도/요청한도/파일 크기 제한, 백오프/캐시 정책

---

## 7) 기술 스택 & 아키텍처

- **FE**: Next.js 14, TS, Tailwind, Zustand
- **BE/DB**: Supabase(Postgres, RLS), Prisma
- **AI**: Gemini 2.5 Flash Lite(OCR/키필드 추출)
- **Deploy**: Vercel, Serverless Cron(리마인드/만료 처리)
- **Observability**: 로그(애플리케이션/감사), 메트릭, 트레이싱(옵션)

### 7.1 서비스 컴포넌트

- API 레이어(REST, /v1), Job 워커(리마인드/만료), Storage(파일), Webhook(세무사/전자서명 연동용)

---

## 8) UX/IA 개요

- IA: 홈(공지/가이드 최소) → **대시보드** → 문서/프로젝트/클라이언트/설정
- 주요 화면:

  1. 대시보드(룰 카드 4 + 그래프 2)
  2. 인보이스 목록/상세(상태, 리마인드 기록)
  3. 문서 템플릿 에디터(미리보기)
  4. DocumentRequest 생성/이력
  5. 프로젝트·클라이언트 상세(연결 문서)

### 8.1 홈 콘텐츠 섹션 (Content Section & 운영 전략)

**목적**: 사용자의 재방문·신뢰·학습을 유도하고, 핵심 행동(첫 문서 생성/첫 인보이스 발행/리마인드 사용)으로 연결되는 **교육형 퍼널**을 제공한다.

**구성(초기)**

- **에버그린 3\~5개**: 프리랜서 세금 팁, 계약·견적 체크리스트, 미수금 예방 가이드
- **제품 공지/릴리즈 노트**: 핵심 변경점·사용 가이드(스크린샷/짧은 동영상)
- **퀵 액션 배치**: 각 카드에 ‘바로 견적 만들기’, ‘인보이스 발행’ 등 CTA
- **법적 고지**: ‘세무/법률 자문 아님’ 디스클레이머 및 세무사 핸드오프 링크

**IA/레이아웃**

- 상단: **피쳐드 카드(1)** + **퀵 액션(3)**
- 중단: **카테고리 묶음(세금·계약·수금)** 2열 카드 그리드(각 3개)
- 하단: **What's New(공지/릴리즈)** + **Popular This Month(조회·체류 상위)**

**카드 컴포넌트 스펙**

- 필드: `title`, `subtitle`, `tag`, `read_time_min`, `updated_at`, `badge(New/Updated)`, `cta_label`, `cta_href`, `persona(P1/P2/P3)`
- 행동: 카드 클릭 → 상세(마크다운), CTA → 기능 화면으로 딥링크

**CMS 스키마(요약)**

- 메타: `content_id`, `type(article/guide/release)`, `slug`, `locale(ko|en)`, `status(draft/scheduled/published)`
- 분류: `topics["tax","contract","invoicing","howto"]`, `persona`, `stage(onboarding/core/retention)`
- 운영: `owner`, `reviewer`, `legal_reviewed(bool)`, `publish_at`, `updated_at`
- SEO: `title`, `meta_desc`, `keywords`, `og:image`
- 측정: `impressions`, `ctr`, `avg_read_time`, `scroll_depth`, `assisted_conversions`

**거버넌스 & 케이던스**

- **주 2편** 발행(에버그린 위주), **법/규정 변경 72시간 내** 업데이트
- 역할: Author(PM/마케팅) → Reviewer(도메인 전문가/세무 파트너) → Approver(PM 리드)
- SLA: 초안→게시 **3영업일**, 롤백 절차(버전 복구 + 공지)

**개인화(룰 기반 v1)**

- 온보딩 단계엔 ‘첫 문서/첫 인보이스’ 관련 카드 우선
- **트리거**: 인보이스 0건 → ‘첫 인보이스 가이드’ 상단 고정(7일)

**SEO & i18n**

- Article 스키마 마크업, Canonical/OG 태그, `ko` 기본·`en` 선택

**KPI / 실험**

- 콘텐츠 CTR ≥ **6%**, 콘텐츠 유입 사용자의 **첫 인보이스 전환 +8%p**
- A/B: 카드 레이아웃(1열 vs 2열), CTA 카피(“만들기” vs “시작하기”)

**리스크·컴플라이언스**

- 세무/법률 오해 방지 고지, 최신성 표기(`updated_at`), 출처 링크

**로드맵**

- **P1**: 에버그린 3\~5개 + 릴리즈 노트 + 퀵 액션
- **P2**: 카테고리/검색, 구독(알림)
- **P3**: 개인화/추천 고도화(행동 기반)

---

## 9) 대시보드 룰 명세 (R1\~R4)

| ID  | 이름           | 설명                        | 의사 쿼리/조건                                                    | 빈값 처리                       | CTA                                     |
| --- | -------------- | --------------------------- | ----------------------------------------------------------------- | ------------------------------- | --------------------------------------- |
| R1  | 결제 지연      | 기한 < 오늘 & 상태≠Paid     | `invoice.due_date < today AND status NOT IN ('Paid','Cancelled')` | 0건이면 회색 카드               | ‘연체 보기’ 필터 이동 & ‘리마인드’ 배치 |
| R2  | 마감 임박      | 프로젝트 마감 D≤7           | `project.due_date BETWEEN today AND today+7`                      | 0건이면 숨김                    | ‘마감순 정렬’, ‘캘린더 보기’            |
| R3  | 발행 vs 입금   | 이번 달 발행 총액/입금 총액 | `sum(issue_date in month), sum(payments in month)`                | 데이터 없음 → 이전 달 대비 안내 | ‘리포트 보기’                           |
| R4  | 상위 고객 기여 | 최근 분기 매출 Top3         | `sum(invoice by client in last quarter)`                          | 거래없음 → 안내 카드            | ‘고객 상세’ 이동                        |

---

## 10) 퍼널 & KPI 가설 (요약)

- 채널→가입→온보딩완료(문서1건)→첫 인보이스 발행→리마인드 사용→유료 전환
- 목표(12개월): 가입→온보딩 60%, 온보딩→첫 인보이스 40%, 인보이스→유료 25%, **MAU 25k → 유료 3.8k ≈ MRR \~1억**

---

## 11) 데이터 모델 (요약 ERD)

**Tenant(User/Team)** —1\:N→ **Client** —1\:N→ **Project** —1\:N→ **Invoice** —1\:N→ **Payment**
**Document(Template/Generated)**, **DocumentRequest**, **CalendarEvent**, **ActivityLog**, **Notification**, **TaxPackage**

### 11.1 주요 테이블 필드(발췌)

- `invoice(id, tenant_id, client_id, project_id, status, issue_date, due_date, subtotal, tax, total, currency, created_at)`
- `payment(id, invoice_id, amount, method, paid_at, memo)`
- `document_request(id, tenant_id, client_id, project_id, token, ttl, status, created_at)`
- `activity_log(id, tenant_id, actor_id, target_type, target_id, action, ip, ua, at)`

### 11.2 RLS 예시

```sql
-- tenant 격리 (읽기)
create policy p_invoice_tenant_read on invoice
for select using (tenant_id = auth.uid());
```

> 실제 구현 시 auth 스키마/매핑 전략에 맞춰 커스터마이즈 필요

---

## 12) API 스펙 (발췌)

### 12.1 인증

- OAuth/Supabase Auth, Bearer 토큰. 모든 요청 **tenant 범위** 검증.

### 12.2 엔드포인트 (예)

- `POST /v1/invoices` 생성
- `GET /v1/invoices?status=Overdue`
- `POST /v1/invoices/{id}/reminders` 리마인드 발송
- `POST /v1/document-requests` 생성 (body: client_id, project_id, ttl, types)
- `GET  /v1/dashboard/insights` (R1\~R4 결과)

### 12.3 공통 에러 코드

- `400` 검증 실패, `401/403` 인증/권한, `409` 상태충돌, `429` 제한, `5xx` 서버

---

## 13) AI 범위 & 가드레일

- **1단계**: OCR + 키 필드 추출(거래일, 공급가, 세액, 총액, 사업자번호)
- 실패 시: 사용자 확인 UI 제공(자동 하이라이트), 저장 전 필수 필드 검증
- 비용 가드: 파일 크기 제한(예: 5MB), 요청 회수/월한도, 캐싱(중복 업로드 차단)

---

## 14) 플랜/가격 & 권한

### 14.1 플랜 권한 매트릭스

| 기능               | Free |    Pro |             Business |
| ------------------ | ---: | -----: | -------------------: |
| 프로젝트 수        |    2 | 무제한 |               무제한 |
| 고객 수            |    5 | 무제한 |               무제한 |
| 문서(월 생성)      |    3 | 무제한 |               무제한 |
| 대시보드 인사이트  | 기본 |   확장 |                 확장 |
| DocumentRequest    | 기본 |   기본 |    고급(템플릿·일괄) |
| AI OCR             |    - |   기본 |           고급(배치) |
| 세무 변환 내보내기 |    - |   기본 | 고급 + 핸드오프 관리 |
| 팀 협업            |    - |    2인 |             5인+권한 |
| 전자서명 연동      |    - |   옵션 |                 옵션 |

> 전자서명/세무 대리신고는 **파트너 계약 체결 전까지 불확실함**. 제공 시 플랜 내 **애드온**으로 과금 권장.

---

## 15) 로드맵 & Exit 기준

| Phase       | 기간   | 목표           | 기능 범위                                                                                                         | **Exit 기준(게이트)**                                                   |
| ----------- | ------ | -------------- | ----------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- |
| **P1(MVP)** | 4\~6주 | E2E 기본 흐름  | 템플릿(견적/인보), 인보이스→입금→리마인드, 대시보드 R1\~R4, DocumentRequest(보안), CRM/프로젝트 최소, 캘린더 읽기 | **실사용 인보이스 ≥ 50건**, 리마인드 성공률 ≥ 95%, 대시보드 오류율 < 1% |
| P2          | 4\~6주 | 편의 고도화    | 견적→계약 변환, 전자서명 연동(옵션), 리포트, 홈 공지                                                              | 계약 변환 성공률 ≥ 90%, 전자서명 라운드트립 ≥ 30건                      |
| P3          | 6\~8주 | AI/세무 차별화 | AI OCR, 세무 변환 패킷/체크리스트/SLA                                                                             | OCR 필드 정확도(Top-5) ≥ 92%, 세무사 피드백 SLA 준수                    |
| P4          | 4\~6주 | 수익화/안정화  | 협업 권한, 퍼포먼스 최적화                                                                                        | 전환율 ≥ 12%, 주요 뷰 p95 < 1.0s                                        |

---

## 16) 측정 & 분석 (Analytics)

- **핵심 이벤트(예)**: `document.created`, `invoice.issued`, `invoice.reminded`, `invoice.paid`, `request.sent`, `request.uploaded`, `dashboard.viewed`, `insight.cta_clicked` ... (15\~20개)
- **속성**: tenant_id, amount, due_in_days, client_tier, file_type, route, latency
- **모니터링**: 오류율, 지연, 리마인드 성공률, 링크 악용 탐지(다중 IP)

---

## 17) 테스트 & QA

### 17.1 테스트 유형

- 유닛/통합/API/시나리오(E2E)/보안/성능/회귀

### 17.2 샘플 테스트 케이스(발췌)

- **TC-INV-001**: 인보이스 발행 시 상태 `Draft→Issued`, 리마인드 규칙 스케줄링됨
- **TC-REM-004**: Overdue 인보이스에 ‘리마인드’ 클릭 → 발송 이력/카운터 증가
- **TC-DRQ-007**: DocumentRequest 링크 만료 후 접근 차단 + 로그 남김
- **TC-DB-011**: 대시보드 R1 쿼리 결과와 상세 목록 일치

### 17.3 품질 게이트

- 주요 흐름(E2E) 성공률 ≥ 98%, 크리티컬 버그 0, 보안 스캔 High 0

---

## 18) 보안·컴플라이언스

- **권한**: Owner/Admin/Member/Viewer(4단), 문서 단위 공유
- **링크 보안**: TTL 기본 7일, 1회용 토큰, IP/UA 로그, 다운로드 횟수 제한(옵션)
- **데이터 보호**: 암호화(전송/저장), 백업/복구, 파기 주기 명시, 접근 권한 최소화

---

## 19) 운영 & SRE

- **SLO**: 알림/리마인드 지연 < 5분(99%), 대시보드 오류율 < 1%
- **알림**: 장애/지연 임계치 → 온콜 통지, 런북: 리마인드 큐 지연/실패 대응 절차
- **릴리즈**: Git→Preview→Staging→Prod, 피처 플래그로 점진 롤아웃

---

## 20) 리스크 & 대응

| 리스크                    | 영향                  | 우선도 | 대응                                             |
| ------------------------- | --------------------- | -----: | ------------------------------------------------ |
| 전자서명/세무 파트너 지연 | 차별화 약화           |   높음 | MVP는 내보내기·핸드오프에 집중, 파트너 병행 발굴 |
| OCR 정확도/비용           | 사용자 불만·비용 초과 |   중간 | 필드 제한·사용자 교정 UI·캐시·월한도             |
| 미수금 리마인드 악용      | 스팸/신뢰도 저하      |   중간 | 발송 제한, 템플릿 가이드, 옵트아웃 링크          |
| 데이터 유출               | 법/신뢰 치명적        |   높음 | RLS/암호화/링크 TTL/감사로그·침해 대응 계획      |

---

## 21) 출시/운영 계획 (GTM)

- **파일럿(베타 100명)**: 커뮤니티/지인 네트워크, 온보딩 세션
- **콘텐츠**: 에버그린 3\~5개(견적/계약 체크리스트, 미수금 예방 가이드, 세무 핸드오프)
- **성과**: 파일럿 NPS/피드백 → P2 반영

---

## 22) 오픈 이슈 (Open Questions)

1. 전자서명 연동 우선 벤더 후보/요건 (불확실)
2. 세무사 파트너 SLA·커버리지(지역/규모) 확정 필요
3. 결제 게이트웨이(수수료/정산 주기) 정책

---

## 23) 부록 (샘플/스키마/템플릿)

### 23.1 문서 변수 예시(견적/인보)

```json
{
  "client": { "name": "주식회사 예시", "biz_no": "123-45-67890" },
  "project": { "name": "웹 리뉴얼", "due_date": "2025-09-15" },
  "invoice": {
    "issue_date": "2025-08-28",
    "due_date": "2025-09-05",
    "subtotal": 2000000,
    "tax": 200000,
    "total": 2200000,
    "currency": "KRW"
  }
}
```

### 23.2 API 응답(예: /v1/dashboard/insights)

```json
{
  "r1_overdue_count": 2,
  "r2_due_7d": 3,
  "r3_month": { "issued": 6200000, "paid": 4100000 },
  "r4_top_clients": [
    { "client_id": "c1", "total": 8200000 },
    { "client_id": "c2", "total": 5100000 }
  ]
}
```

### 23.3 리마인드 템플릿(요지)

- 제목: `[Weave] 결제 예정 안내 – {{invoice.number}}`
- 본문(핵심): 금액/기한/입금계좌/문의처 + 옵트아웃 링크

### 23.4 예시 쿼리(대시보드 R1)

```sql
select id, client_id, total, due_date
from invoice
where tenant_id = :tenant
  and status not in ('Paid','Cancelled')
  and due_date < now()::date
order by due_date asc
limit 50;
```

---

## 24) 다음 액션(1\~2주)

1. **MVP 스코프 동결 회의**: 기능/데이터/Exit 기준 최종합의
2. **템플릿 엔진 시범 구현**: 견적/인보 2종 + 미리보기/버전
3. **E2E 플로우 완성**: 인보이스→입금 추적→리마인드(실사용 20\~50건)
4. **DocumentRequest 보안**: TTL/1회용/감사로그 배포
5. **분석 이벤트 15\~20개** 계측 & 대시보드 카드 연결

---

> 본 문서는 v3.2 기준입니다. 외부 파트너십(전자서명/세무 대리신고)은 **현재 불확실**하며, 계약 확정 시 플랜·SLA·데이터 교환 정책을 본문에 업데이트합니다.
